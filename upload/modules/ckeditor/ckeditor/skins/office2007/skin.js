CKEDITOR.skins.add('office2007',(function(){var j=[],uiColorStylesheetId='cke_ui_color';if(CKEDITOR.env.ie&&CKEDITOR.env.version<7){j.push('icons.png','images/sprites_ie6.png','images/dialog_sides.gif')}return{preload:j,editor:{css:['editor.css']},dialog:{css:['dialog.css']},templates:{css:['templates.css']},margins:[0,14,18,14],init:function(g){var h=/\$color/g;function getStylesheet(a){var b=a.getById(uiColorStylesheetId);if(!b){b=a.getHead().append('style');b.setAttribute("id",uiColorStylesheetId);b.setAttribute("type","text/css")}return b}function updateStylesheets(a,b,c){var r,i,content;for(var d=0;d<a.length;d++){if(CKEDITOR.env.webkit){for(i=0;i<b.length;i++){content=b[i][1];for(r=0;r<c.length;r++)content=content.replace(c[r][0],c[r][1]);a[d].$.sheet.addRule(b[i][0],content)}}else{content=b;for(r=0;r<c.length;r++)content=content.replace(c[r][0],c[r][1]);if(CKEDITOR.env.ie)a[d].$.styleSheet.cssText+=content;else a[d].$.innerHTML+=content}}}CKEDITOR.tools.extend(g,{uiColor:null,getUiColor:function(){return this.uiColor},setUiColor:function(c){var d,uiStyle=getStylesheet(CKEDITOR.document),cssId='.cke_editor_'+g.name;var e=[cssId+" .cke_top",cssId+" .cke_bottom",cssId+" span.cke_wrapper.cke_ltr"].join(',');var f="background-color: $color !important;";if(CKEDITOR.env.webkit)d=[[e,f]];else d=e+'{'+f+'}';return(this.setUiColor=function(a){var b=[[h,a]];g.uiColor=a;updateStylesheets([uiStyle],d,b)})(c)}});if(g.config.uiColor)g.setUiColor(g.config.uiColor)}}})());(function(){CKEDITOR.dialog?dialogSetup():CKEDITOR.on('dialogPluginReady',dialogSetup);function dialogSetup(){CKEDITOR.dialog.on('resize',function(c){var d=c.data,width=d.width,height=d.height,dialog=d.dialog,contents=dialog.parts.contents;if(d.skin!='office2003')return;contents.setStyles({width:width+'px',height:height+'px'});if(!CKEDITOR.env.ie)return;var e=function(){var a=dialog.parts.dialog.getChild([0,0,0]),body=a.getChild(0);var b=a.getChild(2);b.setStyle('width',(body.$.offsetWidth)+'px');b=a.getChild(7);b.setStyle('width',(body.$.offsetWidth-28)+'px');b=a.getChild(4);b.setStyle('height',(body.$.offsetHeight-31-14)+'px');b=a.getChild(5);b.setStyle('height',(body.$.offsetHeight-31-14)+'px')};setTimeout(e,100);if(c.editor.lang.dir=='rtl')setTimeout(e,1000)})}})();